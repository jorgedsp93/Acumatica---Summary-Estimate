Quote Summary Generator (Google Apps Script)

This project provides a Google Apps Script that generates quote summary reports directly from a Google Sheet containing Acumatica estimate data. It creates a color-coded summary sheet, exports it as a PDF, and automatically emails it to the estimating team.

✨ Features

Custom UI menu in Google Sheets (Quote Summary → Create and email PDF).

Input dialog to capture customer, estimate, and opportunity details.

Division-based breakdowns (Construction, Electrical, HVAC, Plumbing, Sprinklers, Subtrade).

Scoped Notes & Exclusions read from a dedicated “Scope of Work” tab.

Automatic PDF export of the formatted summary sheet.

Email delivery to either test recipients or the production estimating mailbox.

Color-coded sections for easy readability.

Versioning system tied to Opportunity numbers (v0, v1, v2, ...).

Error logging into a log sheet and notification emails.

📌 Special Rule

Vendor names are shown only in the Subtrade section of the estimate.
All other divisions hide the vendor column for cleaner presentation.

📂 Sheet Structure

The script expects the following tabs:

Acumatica Estimate – raw exported data from Acumatica.

Quote_Report – generated by the script (overwritten each run).

Scope of Work – contains scope text, notes, and exclusions.

Script_Log – automatically created for logging runs and errors.

🚀 Usage

Open the Google Sheet connected to this script.

Use the menu: Quote Summary → Create and email PDF.

Fill out:

Customer name

Customer address (optional)

Opportunity number

Estimate name

Click Create PDF and Email.

The script generates a formatted report, emails the PDF, and logs the run.

⚙️ Configuration

Inside the script, update the SET constants if needed:

const SET = {
  rawSheet: 'Acumatica Estimate',
  reportSheet: 'Quote_Report',
  scopeSheet: 'Scope of Work',
  testMode: true,                           // flip to false for production
  testRecipients: 'your-email@example.com',
  prodRecipients: 'estimating@example.com',
  tz: Session.getScriptTimeZone(),
  dateFmt: 'yyyy-MM-dd',
  logSheet: 'Script_Log'
};


Set testMode to true while testing.

Set testMode to false for production, so it emails the real team.

📧 Email Output

The email includes:

Subject: {Customer}, {Address}, {Estimate} - {Opportunity #}

Body:

Attached is the quote summary.
Mode: test/live
Quote: -
Opportunity: OP-12345
Estimate: HVAC Upgrade
Customer: ACME Corp
Version: v2
Created: 2025-08-28


Attachment: Quote Summary - YYYY-MM-DD.pdf

🛠️ Development Notes

Uses LockService to prevent concurrent runs.

Handles commas, parentheses, and text in numeric parsing.

Applies row banding, number formats, and alignment for readability.

Scope of Work tab allows dynamic notes & exclusions without hardcoding.

📄 License

MIT License. Use freely, modify, and distribute.
